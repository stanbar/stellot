<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Voting Stellar</title>
    <meta name="description" content="Voting system build on stellar network">
    <meta name="author" content="Stanislaw Baranski">
  </head>
  <body>
    <div id="app">
      <h2>Voting system build on stellar network</h2>

      <h2>{{ distributionAccountId }}</h2>
      <ul>
        <li v-for="balance in balances">
          <span v-if="balance.asset_type === 'native'">LUM: {{ balance.balance }}</span>
          <span v-else>{{ balance.asset_code }} {{ balance.balance }}</span>
        </li>
      </ul>

      <h2>Parties</h2>
      <ul>
        <li v-for="party in parties">
          {{ party.name }} {{ party.votes }}
          <button @click="party.votes += 1">
          </button>

        </li>
      </ul>
      {{ totalVotes }}
    </div>

    <script src="https://unpkg.com/vue"></script>
    <script>
      const app = new Vue({
        el: '#app',
        data: {
          distributionAccountId: 'GA3WFG5ZB4CCEU6JOOTLQ5QPG73EX5E5MM5GZJEJ7CFLY7XZYSG73LEU',
          parties: [
            {name : 'Left', votes: 0},
            {name : 'Right', votes: 0},
            {name : 'Liberity', votes: 0},
            {name : 'Authority', votes: 0},
          ],
          balances: [],
        },
        computed: {
          totalVotes(){
            return this.parties.reduce((sum, party) => { return sum + party.votes}, 0)
          }
        },
        created() {
          fetch('https://horizon-testnet.stellar.org/accounts/GA3WFG5ZB4CCEU6JOOTLQ5QPG73EX5E5MM5GZJEJ7CFLY7XZYSG73LEU')
            .then(response => response.json())
            .then(json => {
              this.balances = json.balances
            })
        }
      })
    </script>
  </body>
</html>
